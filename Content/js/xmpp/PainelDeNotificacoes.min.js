$(function(){"use strict";var r=$("#btnVerificarNotificacoes"),u=new NotificadorWeb,f=$.cookie("xmpp").split("|")[3],e="http://"+window.location.hostname+":8001",c=$.cookie("token"),n=450,o=function(n){return n===3?"Lido":"Não lido"},s=function(n,t,i,r,u,f){var e=$('<a href="#"><div class="alert'+(f===3?" bg-info":" bg-warning")+' "><div class="row"><div class="col-md-8">'+r+'<\/div><div class="col-md-4">'+o(f)+"<\/div><\/div><\/div> <\/a>");e.on("click",function(){n.criarDisplayNotificacao(t,i,r,u)});return e},h=function(n,t){var i=$('<div id="overlay-notificador"><\/div>'),r=$('<div id="painel-notificacoes"><\/div>'),e=$('<div><h4>Notificações<\/h4><div class="row"><div class="col-md-8"><strong>Título<\/strong><\/div> <div class="col-md-4"><strong>Status<\/strong><\/div><\/div><hr/><\/div>'),u=$('<div id="painel-notificacoes-container"><\/div>'),f=$('<div id="painel-notificacoes-lista"><\/div>');r.css({top:55,left:t-n,width:n});i.on("click",function(n){n.preventDefault();n.target===i[0]&&(i.empty(),i.remove())});return u.append(e),u.append(f),r.append(u),i.append(r),$("body").append(i),f},t,i;PubSub.subscribe("notificacoes-leitura-confirmada",function(){var n=$("#painel-notificacoes-lista");n.empty();t(n)});$(window).resize(function(){var t=$("#btnVerificarNotificacoes"),i=t.offset().left+t.width();$("#painel-notificacoes").css({top:55,left:i-n,width:n})});t=function(n){var t=$.cookie("token");$.ajax({type:"GET",url:e+"/wms/api-gateway/notificacoes/mensagem/mensagens-usuario/"+f,dataType:"json",beforeSend:function(n){n.setRequestHeader("Authorization",t)}}).done(function(t){t.data.map(function(t){i(n,t.mensagemId,t.usuarioId,t.titulo,t.conteudo,t.status)})}).fail(function(n){console.log("falha",n)})};i=function(n,t,i,r,f,e){n.append(s(u,t,i,r,f,e))};r.on("click",function(i){i.preventDefault();var r=i.currentTarget.getBoundingClientRect(),u=r.left+r.width/2,f=h(n,u);t(f)})});